# ðŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

ãƒ­ãƒ¼ã‚«ãƒ«ãŠã‚ˆã³æœ¬ç•ªç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆæ–¹æ³•ã‚’èª¬æ˜Žã—ã¾ã™ã€‚

## ðŸ–¥ï¸ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ

### æº–å‚™

```bash
# 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd /Users/x24014xx/Desktop/ãŠéŠã³ã‚·ã‚¹ãƒ†ãƒ 

# 2. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
npm run dev

# 3. åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ ngrok ã‚’èµ·å‹•ï¼ˆWebhook ãƒ†ã‚¹ãƒˆç”¨ï¼‰
ngrok http 3000
```

### Webhook ã®ãƒ†ã‚¹ãƒˆ

#### æ–¹æ³• 1: curl ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ç”¨

```bash
# ãƒ†ã‚¹ãƒˆç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ
cat > test_webhook.sh << 'EOF'
#!/bin/bash

BODY='{"events":[{"type":"message","source":{"userId":"U12345678901234567890123456789012"},"replyToken":"nHuyWiB7yP5Zw52FIkcQT","message":{"type":"text","text":"æ˜Žæ—¥ã¾ã§ã«æ•°å­¦ã®å®¿é¡Œ"}}]}'

# ç½²åã‚’ç”Ÿæˆ
CHANNEL_SECRET="YOUR_CHANNEL_SECRET"
SIGNATURE=$(echo -n "$BODY" | openssl dgst -sha256 -hmac "$CHANNEL_SECRET" -binary | base64)

# Webhook ã‚’é€ä¿¡
curl -X POST http://localhost:3000/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Line-Signature: $SIGNATURE" \
  -d "$BODY"
EOF

# å®Ÿè¡Œ
chmod +x test_webhook.sh
./test_webhook.sh
```

#### æ–¹æ³• 2: Postman ã‚’ä½¿ç”¨

1. Postman ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
2. **New Request** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. **Method**: POST
4. **URL**: `http://localhost:3000/api/webhook`
5. **Headers** ã«ä»¥ä¸‹ã‚’è¿½åŠ :
   - Content-Type: application/json
   - X-Line-Signature: [ç”Ÿæˆã—ãŸç½²å]
6. **Body** (raw JSON): ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’è¨­å®š
7. **Send** ã‚’ã‚¯ãƒªãƒƒã‚¯

## ðŸ“± å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆï¼ˆLINE Botï¼‰

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

#### ãƒ†ã‚¹ãƒˆ 1: åŸºæœ¬çš„ãªèª²é¡Œç™»éŒ²

**å…¥åŠ›**: `æ˜Žæ—¥ã¾ã§ã«æ•°å­¦ã®å®¿é¡Œ`

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
ðŸ“ ç™»éŒ²ã—ãŸã‚ˆï¼

ã‚¿ã‚¤ãƒˆãƒ«ï¼šæ•°å­¦ã®å®¿é¡Œ
ç· åˆ‡ï¼š2024-11-15
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- [ ] Bot ãŒå³åº§ã«å¿œç­”ã™ã‚‹
- [ ] Supabase ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¿ã‚¤ãƒˆãƒ«ã¨ç· åˆ‡ãŒæ­£ç¢º

#### ãƒ†ã‚¹ãƒˆ 2: è¤‡æ•°å˜èªžã®èª²é¡Œ

**å…¥åŠ›**: `æ¥é€±é‡‘æ›œã¾ã§ã«ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³‡æ–™ã‚’ä½œæˆã™ã‚‹`

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
ðŸ“ ç™»éŒ²ã—ãŸã‚ˆï¼

ã‚¿ã‚¤ãƒˆãƒ«ï¼šãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³‡æ–™ã‚’ä½œæˆã™ã‚‹
ç· åˆ‡ï¼š2024-11-22
```

#### ãƒ†ã‚¹ãƒˆ 3: æœˆæ—¥æŒ‡å®š

**å…¥åŠ›**: `11æœˆ25æ—¥ã¾ã§ã«ãƒ¬ãƒãƒ¼ãƒˆæå‡º`

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
ðŸ“ ç™»éŒ²ã—ãŸã‚ˆï¼

ã‚¿ã‚¤ãƒˆãƒ«ï¼šãƒ¬ãƒãƒ¼ãƒˆæå‡º
ç· åˆ‡ï¼š2024-11-25
```

#### ãƒ†ã‚¹ãƒˆ 4: è¤‡æ•°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡

ä»¥ä¸‹ã‚’é †ã«é€ä¿¡:

```
1. æ˜Žæ—¥ã¾ã§ã«æ•°å­¦ã®å®¿é¡Œ
2. æ¥é€±ã¾ã§ã«ãƒ¬ãƒãƒ¼ãƒˆæå‡º
3. 11æœˆ25æ—¥ã¾ã§ã«è‹±èªžå‹‰å¼·
4. 3æ—¥å¾Œã¾ã§ã«ææ¡ˆä½œæˆ
5. é€±æœ«ã¾ã§ã«ãƒ—ãƒ¬ã‚¼ãƒ³æº–å‚™
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- [ ] ã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¿œç­”ãŒã‚ã‚‹
- [ ] Supabase ã« 5 ã¤ã™ã¹ã¦ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¿ã‚¤ãƒˆãƒ«ã¨ç· åˆ‡ãŒæ­£ç¢ºã«æŠ½å‡ºã•ã‚Œã¦ã„ã‚‹

## ðŸ”„ Cron ã‚¸ãƒ§ãƒ–ã®ãƒ†ã‚¹ãƒˆ

### ãƒªãƒžã‚¤ãƒ³ãƒ‰ API ã‚’æ‰‹å‹•å®Ÿè¡Œ

```bash
# Supabase ã§æ˜Žæ—¥ã®èª²é¡Œã‚’ä½œæˆ
INSERT INTO tasks (user_id, title, deadline, done)
VALUES (
  'U12345678901234567890123456789012',
  'ãƒ†ã‚¹ãƒˆèª²é¡Œ',
  CURRENT_DATE + INTERVAL '1 day',
  false
);

# ãƒªãƒžã‚¤ãƒ³ãƒ‰ API ã‚’å‘¼ã³å‡ºã—
curl -X GET http://localhost:3000/api/remind \
  -H "Authorization: Bearer your_secret_key"
```

**æœŸå¾…ã•ã‚Œã‚‹å¿œç­”**:
```json
{
  "success": true,
  "remindersSentTomorrow": 1,
  "remindersSentToday": 0,
  "totalReminders": 1
}
```

## ðŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

### ç½²åæ¤œè¨¼ãƒ†ã‚¹ãƒˆ

```bash
# ç„¡åŠ¹ãªç½²åã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
curl -X POST http://localhost:3000/api/webhook \
  -H "Content-Type: application/json" \
  -H "X-Line-Signature: invalid_signature" \
  -d '{"events":[...]}'

# æœŸå¾…ã•ã‚Œã‚‹å¿œç­”: 401 Unauthorized
```

---

ã“ã®ã‚¬ã‚¤ãƒ‰ã«å¾“ã†ã“ã¨ã§ã€ã—ã£ã‹ã‚Šã¨ãƒ†ã‚¹ãƒˆã§ãã¾ã™ï¼ðŸš€
